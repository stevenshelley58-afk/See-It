/* See It Modal - Premium UI Contract (Strict Scoping) */

/* 
 * CRITICAL SAFETY RULE: 
 * NO global selectors (*, body, h1, button, etc) allowed at root level.
 * All styles MUST be scoped to .see-it-widget-hook or .see-it-modal 
 */

@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap');

/* =========================================
   1. Design Tokens (Scoped to roots)
   ========================================= */
.see-it-widget-hook,
.see-it-modal {
  /* Typography */
  --si-font: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  --si-title-size-mobile: 24px;
  /* Refined for mobile balance */
  --si-title-size-desktop: 32px;
  --si-body-size: 15px;
  --si-label-size: 11px;
  --si-tracking-title: -0.025em;
  /* Tighter for premium feel */
  --si-tracking-label: 0.12em;
  /* Wider for uppercase */
  --si-line-title: 1.25;
  --si-line-body: 1.6;

  /* Color */
  --si-bg: #FAFAFA;
  --si-surface: #FFFFFF;
  --si-text: #171717;
  /* Sharper black */
  --si-muted: #737373;
  --si-muted-2: #A3A3A3;
  --si-border: #E5E5E5;
  --si-border-soft: #F5F5F5;
  /* Softer divider */
  --si-cta: #171717;
  --si-cta-hover: #000000;
  --si-success: #22C55E;
  --si-danger: #EF4444;

  /* Radii */
  --si-radius-card: 16px;
  --si-radius-btn: 12px;
  --si-radius-pill: 9999px;
  --si-radius-chip: 6px;

  /* Elevation / Shadows (Refined) */
  --si-shadow-card: 0 1px 2px rgba(0, 0, 0, 0.04), 0 4px 12px rgba(0, 0, 0, 0.02);
  /* Clean, flat-ish */
  --si-shadow-float: 0 8px 24px rgba(0, 0, 0, 0.08), 0 4px 8px rgba(0, 0, 0, 0.04);
  --si-shadow-modal: 0 32px 64px -12px rgba(0, 0, 0, 0.14);
  /* Deep, soft drop */

  /* Motion */
  --si-ease: cubic-bezier(0.16, 1, 0.3, 1);
  /* Apple-style spring-ish ease */
  --si-duration-fast: 150ms;
  --si-duration-base: 250ms;
  --si-duration-slow: 400ms;

  /* Sizing */
  --si-hit: 44px;
  --si-cta-min-h: 48px;
  /* Taller, more confident */
}

/* =========================================
   2. Reset & Safety (Scoped)
   ========================================= */

/* Protect against hostile themes setting "all: unset" or wild box-sizing */
.see-it-widget-hook *,
.see-it-modal * {
  box-sizing: border-box;
  font-family: var(--si-font);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.see-it-widget-hook button,
.see-it-modal button {
  appearance: button;
  background: transparent;
  border: none;
  cursor: pointer;
  margin: 0;
  padding: 0;
  font: inherit;
  color: inherit;
  text-align: center;
  text-transform: none;
  overflow: visible;
  line-height: normal;
  -webkit-appearance: button;
  -webkit-tap-highlight-color: transparent;
}

.see-it-widget-hook img,
.see-it-modal img {
  border-style: none;
  /* IE fix */
  max-width: 100%;
  height: auto;
  display: block;
}

/* =========================================
   3. Primitives (Shared Classes)
   ========================================= */

/* Primary Pill CTA */
.see-it-btn-primary-pill {
  display: flex !important;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  background-color: var(--si-cta) !important;
  color: #FFFFFF !important;
  min-height: var(--si-cta-min-h);
  border-radius: var(--si-radius-pill) !important;
  border: none !important;
  font-weight: 600;
  font-size: var(--si-body-size);
  letter-spacing: -0.01em;
  transition: all var(--si-duration-base) var(--si-ease);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
  /* Minimal lift default */
}

.see-it-btn-primary-pill:hover {
  background-color: var(--si-cta-hover) !important;
  transform: translateY(-1px);
  box-shadow: var(--si-shadow-float);
}

.see-it-btn-primary-pill:active {
  transform: scale(0.99);
  box-shadow: none;
}

.see-it-btn-primary-pill svg {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
  stroke: currentColor;
}

/* Secondary Pill CTA */
.see-it-btn-outline-pill {
  display: flex !important;
  align-items: center;
  justify-content: center;
  gap: 8px;
  width: 100%;
  background-color: var(--si-surface) !important;
  color: var(--si-text) !important;
  min-height: var(--si-cta-min-h);
  border-radius: var(--si-radius-pill) !important;
  border: 1px solid var(--si-border) !important;
  font-weight: 500;
  font-size: var(--si-body-size);
  transition: all var(--si-duration-base) var(--si-ease);
}

.see-it-btn-outline-pill:hover {
  border-color: var(--si-muted-2) !important;
  background-color: #f9f9f9 !important;
}

.see-it-btn-outline-pill:active {
  transform: scale(0.99);
  background-color: var(--si-border-soft) !important;
}

/* Card Primitive */
.see-it-card {
  background: var(--si-surface);
  border-radius: var(--si-radius-card);
  border: 1px solid var(--si-border-soft);
  box-shadow: var(--si-shadow-card);
}

/* =========================================
   4. PDP Widget Styling
   ========================================= */

/* The hook itself acts as the card container */
.see-it-widget-hook {
  background: var(--si-surface);
  border-radius: var(--si-radius-card);
  /* OR adhere to theme if desired, but spec says premium card tokens */
  border: 1px solid var(--si-border-soft);
  box-shadow: var(--si-shadow-card);
  padding: 16px;
  margin: 16px 0;
  /* reasonable default spacing */
  width: 100%;
}

.see-it-widget-content {
  margin-bottom: 12px;
}

.see-it-widget-title {
  font-size: 15px;
  font-weight: 600;
  margin: 0 0 4px 0;
  letter-spacing: var(--si-tracking-title);
  line-height: var(--si-line-title);
  color: var(--si-text);
  display: block;
  /* Ensure it's not hidden by theme */
}

.see-it-widget-description {
  font-size: 14px;
  /* Slightly larger than 13px for premium feel */
  line-height: 1.4;
  color: var(--si-muted);
  margin: 0;
  font-weight: 400;
  display: block;
}

/* =========================================
   5. Modal Structure (Strict Scoping)
   ========================================= */
.see-it-modal {
  position: fixed;
  z-index: 2147483647;
  /* Max safe z-index */
  inset: 0;
  width: 100%;
  height: 100%;
  /* Fallback */
  height: 100dvh;
  overflow: hidden;
  background-color: rgba(250, 250, 250, 0.85);
  /* Light premium backdrop */
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(12px);
  opacity: 0;
  pointer-events: none;
  transition: opacity var(--si-duration-base) var(--si-ease);
}

.see-it-modal:not(.hidden) {
  opacity: 1;
  pointer-events: auto;
}

.see-it-modal.hidden {
  display: none !important;
  /* Force hide */
}

.see-it-modal-content {
  position: relative;
  width: 100%;
  height: 100%;
  height: 100dvh;
  background: var(--si-surface);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: var(--si-shadow-modal);
}

@media (min-width: 768px) {
  .see-it-modal-content {
    /* Desktop Modal Window */
    width: 100%;
    max-width: 1100px;
    /* Generous workspace */
    height: auto;
    max-height: 85vh;
    aspect-ratio: 16/9;
    /* Cinematic */
    border-radius: 24px;
    /* Larger radius for desktop window */
    border: 1px solid rgba(255, 255, 255, 0.5);
    /* Glass edge */
  }
}

/* Prevent scroll on body only when modal is open - handled by JS class toggle on body */
/* We can't put global body styles here safely without risking leakage if we used 'body.open' selector. 
   JS should add class to body, but we'll scope our reaction to that class? 
   Actually, the best practice for extension is to set `overflow: hidden` on body via JS inline style or a very specific utility class. 
   We will strictly NOT style `body` here. */

/* =========================================
   6. Screen System (Entry, Prepare, Position, Result)
   ========================================= */

.see-it-screen {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  background: var(--si-bg);
  /* Use token background */
  display: flex;
  flex-direction: column;
  opacity: 0;
  transform: translateX(20px);
  pointer-events: none;
  transition: opacity var(--si-duration-base) var(--si-ease),
    transform var(--si-duration-base) var(--si-ease);
  overflow-y: auto;
  overflow-x: hidden;
}

.see-it-screen.active {
  opacity: 1;
  transform: translateX(0);
  pointer-events: auto;
  z-index: 10;
}

/* Header */
.see-it-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 20px;
  background: var(--si-surface);
  border-bottom: 1px solid var(--si-border-soft);
  flex-shrink: 0;
}

.see-it-header-title {
  color: var(--si-muted);
  font-size: 11px;
  letter-spacing: var(--si-tracking-label);
  text-transform: uppercase;
  font-weight: 600;
}

.see-it-btn-icon {
  background: transparent;
  border: none;
  color: var(--si-text);
  padding: 8px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: background var(--si-duration-fast);
}

.see-it-btn-icon:hover {
  background: var(--si-border-soft);
}

.see-it-btn-icon svg {
  width: 24px;
  height: 24px;
}

/* =========================================
   7. Specific Screen Layouts
   ========================================= */

/* Entry Screen */
.see-it-entry-content {
  flex: 1;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  padding: 32px 24px;
  text-align: center;
  max-width: 480px;
  margin: 0 auto;
  width: 100%;
}

.see-it-entry-title {
  font-size: var(--si-title-size-mobile);
  font-weight: 600;
  color: var(--si-text);
  letter-spacing: var(--si-tracking-title);
  margin: 0 0 12px 0;
  line-height: var(--si-line-title);
}

@media (min-width: 768px) {
  .see-it-entry-title {
    font-size: var(--si-title-size-desktop);
  }
}

.see-it-entry-description {
  color: var(--si-muted);
  font-size: 16px;
  line-height: 1.5;
  margin: 0 0 40px 0;
  font-weight: 400;
}

.see-it-entry-actions {
  width: 100%;
  display: flex;
  flex-direction: column;
  gap: 12px;
}

@media (min-width: 768px) {
  .see-it-entry-actions {
    flex-direction: row;
    /* Desktop layout usually puts these side by side or splits the screen. 
       Keeping it simple based on "No Drift" rule: Ensure buttons are visible. */
  }
}

/* Product Card Helper (used in entry or result) */
.see-it-product-card-compact {
  background: var(--si-surface);
  border-radius: 12px;
  padding: 12px;
  display: flex;
  align-items: center;
  gap: 12px;
  border: 1px solid var(--si-border-soft);
  margin-bottom: 24px;
  width: 100%;
  text-align: left;
}

.see-it-product-card-compact img {
  width: 48px;
  height: 48px;
  object-fit: cover;
  border-radius: 8px;
  background: var(--si-bg);
}

.see-it-product-info-compact p {
  margin: 0;
}

.see-it-product-title-compact {
  font-size: 14px;
  font-weight: 600;
  color: var(--si-text);
}

.see-it-product-price-compact {
  font-size: 13px;
  color: var(--si-muted);
}

/* Prepare Screen */
.see-it-prepare-room-container {
  flex: 1;
  position: relative;
  background: #f0f0f0;
  overflow: hidden;
  display: flex;
  align-items: center;
  justify-content: center;
}

.see-it-modal .see-it-room-preview {
  width: 100%;
  height: 100%;
  object-fit: contain;
  display: block;
}

.see-it-modal .see-it-mask-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  pointer-events: auto;
  touch-action: none;
  z-index: 2;
}

.see-it-prepare-bottom {
  background: var(--si-surface);
  padding: 20px 24px;
  border-top: 1px solid var(--si-border-soft);
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.see-it-prepare-actions-row {
  display: flex;
  gap: 12px;
  justify-content: space-between;
}

/* Position Screen */
.see-it-position-controls {
  padding: 24px;
  background: var(--si-surface);
  border-top: 1px solid var(--si-border-soft);
  display: flex;
  flex-direction: column;
  gap: 16px;
}

.see-it-save-room-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-size: 14px;
  font-weight: 500;
  color: var(--si-text);
}

/* Result Screen */
.see-it-result-success {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 12px;
  background: rgba(34, 197, 94, 0.1);
  color: var(--si-success);
  border-radius: var(--si-radius-chip);
  font-size: 13px;
  font-weight: 600;
  margin-bottom: 16px;
}

/* Utils */
.see-it-hidden {
  display: none !important;
}
