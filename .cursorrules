# See It App - Cursor Rules

## üîí AI MODEL NAMES - DO NOT MODIFY

The AI model names (Gemini, Imagen) are **LOCKED** and must not be changed without explicit user approval.

### Why this matters
Previous agents have repeatedly changed model names to incorrect values, breaking the app. The correct model names have been verified against Google's official documentation.

### Model config locations (SINGLE SOURCE OF TRUTH)
- `app/app/config/ai-models.config.ts` - Remix app
- `image-service/ai-models.config.js` - Image service

### Rules for AI models
1. **NEVER** define model names directly in service files
2. **ALWAYS** import from the config files above
3. **NEVER** suggest changing model names without checking Google's docs first
4. If you think a model name is outdated, ask the user first and cite your source

### Current valid models (as of Dec 2024)
- `gemini-2.5-flash-image` - Fast image editing
- `gemini-3-pro-image-preview` - Pro image editing (supports 4K)
- `imagen-4.0-generate-001` - Text-to-image (NOT for editing)

### Invalid model names (DO NOT USE)
- ‚ùå `gemini-2.5-flash-image-preview`
- ‚ùå `gemini-3-pro-image`
- ‚ùå `imagen-3.0-capability-001`
- ‚ùå `gemini-2.0-flash-preview-image-generation`

### Reference docs
- https://ai.google.dev/gemini-api/docs/image-generation
- https://ai.google.dev/gemini-api/docs/models
- `app/docs/GEMINI_MODELS_REFERENCE.md`

---

## Background Removal
The app uses `@imgly/background-removal-node` for product background removal, NOT Gemini.
**Reason:** Gemini cannot output transparent PNGs - it outputs white backgrounds instead.

---

## üéØ Object Removal (Inpainting) - MUST USE CLIPDROP

**Object removal uses Clipdrop Cleanup API, NOT Vertex AI Imagen.**

### Why Clipdrop?
- ‚úÖ **Better results** - Cleaner inpainting
- ‚úÖ **Faster** - Direct API, no multi-hop latency
- ‚úÖ **Simpler** - REST API with FormData

### Implementation
- **Backend:** `app/app/services/image-removal.server.ts` - Uses `CLIPDROP_API_KEY`
- **Endpoint:** `https://clipdrop-api.co/cleanup/v1`
- **Frontend:** `app/extensions/see-it-extension/assets/see-it-modal.js` - Dual canvas architecture

### ‚ùå DO NOT USE for object removal:
- Vertex AI Imagen 3 (`EDIT_MODE_INPAINT_REMOVAL`)
- Google Gemini image editing
- Any other AI model

### Canvas Architecture (Frontend)
The frontend uses a **dual-canvas approach** (from cleanup-ai reference):
1. **Visual canvas** - UI-sized, shows cyan highlights
2. **Hidden mask canvas** - Native resolution, white on black for API

**DO NOT simplify to single canvas** - This causes blurry results.

---

## General Rules
- Follow existing code patterns and conventions
- Don't refactor code unless specifically asked
- Test changes before suggesting them as complete
