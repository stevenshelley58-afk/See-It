<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>See It Widget — Complete Flow Demo</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f5f5;
      color: #171717;
      -webkit-font-smoothing: antialiased;
      min-height: 100vh;
    }

    /* =============================================
       DEMO LAYOUT
    ============================================= */
    .demo-header {
      background: #fff;
      border-bottom: 1px solid #e5e5e5;
      padding: 20px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .demo-header-inner {
      max-width: 1400px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 20px;
      flex-wrap: wrap;
    }

    .demo-title {
      font-size: 18px;
      font-weight: 600;
    }

    .demo-controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }

    .demo-btn {
      padding: 8px 16px;
      background: #fff;
      border: 1px solid #e5e5e5;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.15s;
    }

    .demo-btn:hover { border-color: #171717; }
    .demo-btn.active { background: #171717; color: #fff; border-color: #171717; }

    .demo-views {
      max-width: 1400px;
      margin: 0 auto;
      padding: 40px 20px;
      display: grid;
      grid-template-columns: 375px 1fr;
      gap: 40px;
      align-items: start;
    }

    @media (max-width: 900px) {
      .demo-views {
        grid-template-columns: 1fr;
        max-width: 500px;
      }
    }

    .view-section h3 {
      font-size: 11px;
      font-weight: 600;
      letter-spacing: 0.1em;
      text-transform: uppercase;
      color: #a3a3a3;
      margin-bottom: 16px;
    }

    /* Mobile frame */
    .mobile-frame {
      background: #000;
      border-radius: 48px;
      padding: 12px;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25);
    }

    .mobile-screen {
      background: #fff;
      border-radius: 40px;
      overflow: hidden;
      height: 750px;
      position: relative;
    }

    /* Desktop frame */
    .desktop-frame {
      background: rgba(255,255,255,0.8);
      backdrop-filter: blur(20px);
      border-radius: 20px;
      padding: 20px;
      border: 1px solid rgba(0,0,0,0.06);
      box-shadow: 0 20px 40px -12px rgba(0,0,0,0.1);
    }

    .desktop-screen {
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      aspect-ratio: 4/3;
      position: relative;
      min-height: 500px;
    }

    /* =============================================
       WIDGET TOKENS
    ============================================= */
    .widget {
      --si-font: 'Inter', -apple-system, sans-serif;
      --si-bg: #fafafa;
      --si-surface: #fff;
      --si-text: #171717;
      --si-muted: #737373;
      --si-muted-2: #a3a3a3;
      --si-border: #e5e5e5;
      --si-border-soft: #f0f0f0;
      --si-cta: #171717;
      --si-success: #16a34a;
      --si-radius-btn: 100px;
      --si-ease: cubic-bezier(0.16, 1, 0.3, 1);

      font-family: var(--si-font);
      height: 100%;
      display: flex;
      flex-direction: column;
      background: var(--si-bg);
    }

    /* =============================================
       SCREEN SYSTEM
    ============================================= */
    .screen {
      position: absolute;
      inset: 0;
      display: none;
      flex-direction: column;
      background: var(--si-bg);
    }

    .screen.active {
      display: flex;
    }

    /* =============================================
       HEADER - Minimal
    ============================================= */
    .widget-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      background: var(--si-surface);
      border-bottom: 1px solid var(--si-border-soft);
      min-height: 56px;
    }

    .btn-icon {
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: none;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.15s;
      color: var(--si-text);
    }

    .btn-icon:hover { background: var(--si-border-soft); }
    .btn-icon svg { width: 24px; height: 24px; }

    .header-spacer { width: 40px; }

    /* =============================================
       CANVAS AREA - Room + Product
    ============================================= */
    .canvas-area {
      flex: 1;
      position: relative;
      overflow: hidden;
      background: #f0f0f0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .canvas-area img.room {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* Product overlay */
    .product-overlay {
      position: absolute;
      cursor: move;
      touch-action: none;
      user-select: none;
      transition: filter 0.2s;
    }

    .product-overlay img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      filter: drop-shadow(0 8px 20px rgba(0,0,0,0.15));
    }

    .product-overlay::after {
      content: '';
      position: absolute;
      inset: -4px;
      border: 2px dashed transparent;
      border-radius: 4px;
      transition: border-color 0.15s;
      pointer-events: none;
    }

    .product-overlay:hover::after,
    .product-overlay.dragging::after {
      border-color: rgba(0,0,0,0.2);
    }

    /* =============================================
       FOOTER ACTIONS
    ============================================= */
    .widget-footer {
      padding: 16px 20px;
      background: var(--si-surface);
      border-top: 1px solid var(--si-border-soft);
    }

    .btn-primary {
      width: 100%;
      background: var(--si-cta);
      color: #fff;
      border: none;
      padding: 16px 24px;
      border-radius: var(--si-radius-btn);
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: all 0.2s var(--si-ease);
    }

    .btn-primary:hover {
      background: #000;
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .btn-primary:active { transform: scale(0.98); }
    .btn-primary:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .btn-primary svg { width: 20px; height: 20px; }

    /* =============================================
       RESULT SCREEN
    ============================================= */
    .result-image-wrap {
      flex: 1;
      position: relative;
      overflow: hidden;
      background: #f5f5f5;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .result-image-wrap img {
      width: 100%;
      height: 100%;
      object-fit: contain;
    }

    .result-actions {
      padding: 16px 20px;
      background: var(--si-surface);
      border-top: 1px solid var(--si-border-soft);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .result-secondary {
      display: flex;
      justify-content: center;
      gap: 4px;
    }

    .btn-text {
      background: none;
      border: none;
      color: var(--si-muted);
      font-size: 13px;
      font-weight: 500;
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.15s;
    }

    .btn-text:hover {
      color: var(--si-text);
      background: var(--si-border-soft);
    }

    .btn-text svg { width: 16px; height: 16px; }

    /* =============================================
       EMAIL CAPTURE
    ============================================= */
    .email-section {
      padding: 16px 20px;
      background: #fafafa;
      border-top: 1px solid var(--si-border-soft);
    }

    .email-label {
      font-size: 13px;
      color: var(--si-muted);
      margin-bottom: 10px;
      font-weight: 500;
    }

    .email-form {
      display: flex;
      gap: 8px;
    }

    .email-form input {
      flex: 1;
      padding: 12px 14px;
      border: 1px solid var(--si-border);
      border-radius: 10px;
      font-size: 14px;
      font-family: var(--si-font);
      outline: none;
      transition: border-color 0.15s;
      background: #fff;
      min-width: 0;
    }

    .email-form input:focus { border-color: var(--si-text); }
    .email-form input::placeholder { color: var(--si-muted-2); }

    .email-form button {
      padding: 12px 20px;
      background: var(--si-cta);
      color: #fff;
      border: none;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      font-family: var(--si-font);
      cursor: pointer;
      white-space: nowrap;
      transition: background 0.15s;
    }

    .email-form button:hover { background: #000; }
    .email-form button:disabled { opacity: 0.5; }

    .email-success {
      display: none;
      align-items: center;
      gap: 8px;
      color: var(--si-success);
      font-size: 14px;
      font-weight: 500;
    }

    .email-success.show { display: flex; }
    .email-success svg { width: 20px; height: 20px; }

    /* =============================================
       LOADING OVERLAY
    ============================================= */
    .loading-overlay {
      position: absolute;
      inset: 0;
      background: rgba(255,255,255,0.95);
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 16px;
      z-index: 10;
    }

    .loading-overlay.show { display: flex; }

    .spinner {
      width: 40px;
      height: 40px;
      border: 3px solid #e5e5e5;
      border-top-color: #171717;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin { to { transform: rotate(360deg); } }

    .loading-text {
      font-size: 14px;
      color: var(--si-muted);
      font-weight: 500;
    }

    /* =============================================
       DESKTOP ADJUSTMENTS
    ============================================= */
    @media (min-width: 768px) {
      .desktop-screen .result-actions {
        flex-direction: row;
        align-items: center;
        gap: 16px;
      }

      .desktop-screen .result-actions .btn-primary {
        width: auto;
        flex: 0 0 auto;
      }

      .desktop-screen .result-secondary {
        flex: 1;
        justify-content: flex-start;
      }

      .desktop-screen .email-section {
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .desktop-screen .email-label {
        margin: 0;
        white-space: nowrap;
      }

      .desktop-screen .email-form {
        flex: 1;
        max-width: 400px;
      }
    }

    /* =============================================
       TOAST
    ============================================= */
    .toast {
      position: fixed;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) translateY(20px);
      background: #171717;
      color: #fff;
      padding: 12px 24px;
      border-radius: 100px;
      font-size: 14px;
      font-weight: 500;
      opacity: 0;
      pointer-events: none;
      transition: all 0.3s var(--si-ease);
      z-index: 9999;
    }

    .toast.show {
      opacity: 1;
      transform: translateX(-50%) translateY(0);
    }

    /* Hide utility */
    .hidden { display: none !important; }

    /* =============================================
       RESIZE HANDLES
    ============================================= */
    .resize-handle {
      position: absolute;
      width: 24px;
      height: 24px;
      background: #fff;
      border: 2px solid #171717;
      border-radius: 50%;
      opacity: 0;
      transition: opacity 0.15s;
      z-index: 10;
    }

    .product-overlay:hover .resize-handle,
    .product-overlay.dragging .resize-handle,
    .product-overlay.resizing .resize-handle {
      opacity: 1;
    }

    .resize-nw { top: -12px; left: -12px; cursor: nw-resize; }
    .resize-ne { top: -12px; right: -12px; cursor: ne-resize; }
    .resize-sw { bottom: -12px; left: -12px; cursor: sw-resize; }
    .resize-se { bottom: -12px; right: -12px; cursor: se-resize; }

    /* Position hint */
    .position-hint {
      position: absolute;
      bottom: 16px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.7);
      color: #fff;
      padding: 8px 16px;
      border-radius: 100px;
      font-size: 12px;
      font-weight: 500;
      pointer-events: none;
      white-space: nowrap;
      transition: opacity 0.3s;
    }

    .position-hint.hidden {
      opacity: 0;
    }

    /* =============================================
       BRUSH SIZE SLIDER - Simple
    ============================================= */
    .brush-size-control {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .brush-size-control span {
      font-size: 13px;
      color: var(--si-muted);
      white-space: nowrap;
    }

    .brush-slider {
      flex: 1;
      height: 2px;
      -webkit-appearance: none;
      appearance: none;
      background: #d4d4d4;
      border-radius: 1px;
      outline: none;
    }

    .brush-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: #171717;
      border-radius: 50%;
      cursor: pointer;
    }

    .brush-slider::-moz-range-thumb {
      width: 14px;
      height: 14px;
      background: #171717;
      border-radius: 50%;
      cursor: pointer;
      border: none;
    }

    /* =============================================
       PRODUCT SWIPER - Tinder style
    ============================================= */
    .product-swiper {
      display: none;
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.8);
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 30;
      padding: 20px;
    }

    .product-swiper.show { display: flex; }

    .swiper-close {
      position: absolute;
      top: 16px;
      right: 16px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #fff;
    }

    .swiper-card {
      background: #fff;
      border-radius: 16px;
      overflow: hidden;
      width: 100%;
      max-width: 280px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      transition: transform 0.3s ease;
    }

    .swiper-card.swiping-left {
      transform: translateX(-20px) rotate(-5deg);
    }

    .swiper-card.swiping-right {
      transform: translateX(20px) rotate(5deg);
    }

    .swiper-card img {
      width: 100%;
      aspect-ratio: 1;
      object-fit: cover;
      background: #f5f5f5;
    }

    .swiper-card-info {
      padding: 16px;
      text-align: center;
    }

    .swiper-card-name {
      font-size: 16px;
      font-weight: 600;
      color: var(--si-text);
      margin-bottom: 4px;
    }

    .swiper-card-collection {
      font-size: 12px;
      color: var(--si-muted);
    }

    .swiper-hint {
      color: rgba(255,255,255,0.6);
      font-size: 12px;
      margin-top: 16px;
    }

    .swiper-actions {
      display: flex;
      gap: 16px;
      margin-top: 20px;
    }

    .swiper-btn {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: transform 0.15s;
    }

    .swiper-btn:hover {
      transform: scale(1.1);
    }

    .swiper-btn:active {
      transform: scale(0.95);
    }

    .swiper-btn-skip {
      background: rgba(255,255,255,0.2);
      color: #fff;
    }

    .swiper-btn-select {
      background: #fff;
      color: var(--si-text);
    }

    .swiper-btn svg {
      width: 24px;
      height: 24px;
    }

    .swiper-btn-try {
      background: #fff;
      color: var(--si-text);
      border: none;
      padding: 14px 28px;
      border-radius: 100px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: transform 0.15s;
    }

    .swiper-btn-try:hover {
      transform: scale(1.05);
    }

    .desktop-actions {
      margin-top: 24px;
    }

    /* Desktop arrows */
    .swiper-nav {
      display: none;
    }

    @media (min-width: 768px) {
      .swiper-card {
        max-width: 320px;
      }

      .swiper-nav {
        display: flex;
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        width: calc(100% - 40px);
        justify-content: space-between;
        pointer-events: none;
      }

      .swiper-nav button {
        pointer-events: auto;
        width: 48px;
        height: 48px;
        border-radius: 50%;
        border: none;
        background: rgba(255,255,255,0.9);
        color: var(--si-text);
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.15s;
      }

      .swiper-nav button:hover {
        transform: scale(1.1);
      }

      .swiper-hint {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- Demo Header -->
  <div class="demo-header">
    <div class="demo-header-inner">
      <div class="demo-title">See It Widget — Complete Flow</div>
      <div class="demo-controls">
        <button class="demo-btn" onclick="setScreen('all', 'entry')">1. Entry</button>
        <button class="demo-btn" onclick="setScreen('all', 'prepare')">2. Prepare</button>
        <button class="demo-btn active" onclick="setScreen('all', 'position')">3. Position</button>
        <button class="demo-btn" onclick="setScreen('all', 'loading')">4. Loading</button>
        <button class="demo-btn" onclick="setScreen('all', 'result')">5. Result</button>
      </div>
    </div>
  </div>

  <div class="demo-views">
    <!-- MOBILE -->
    <div class="view-section">
      <h3>Mobile (375px)</h3>
      <div class="mobile-frame">
        <div class="mobile-screen">
          <div class="widget" id="mobile-widget">
            
            <!-- ENTRY SCREEN -->
            <div class="screen" id="mobile-entry">
              <div class="widget-header">
                <button class="btn-icon" onclick="closeWidget()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:32px 24px; text-align:center;">
                <div style="background:#f5f5f5; border-radius:12px; padding:12px; display:flex; gap:12px; align-items:center; margin-bottom:32px; width:100%;">
                  <img src="https://i.imgur.com/8xqBxKp.png" style="width:56px; height:56px; object-fit:contain; background:#fff; border-radius:8px;">
                  <div style="text-align:left;">
                    <div style="font-weight:600; font-size:14px;">Antique Mirror</div>
                  </div>
                </div>
                <h1 style="font-size:24px; font-weight:600; margin-bottom:8px;">See it in your space</h1>
                <p style="color:#737373; font-size:15px; margin-bottom:32px;">Take a photo of your room to see how this looks.</p>
                <div style="width:100%; display:flex; flex-direction:column; gap:12px;">
                  <button class="btn-primary" onclick="setScreen('mobile', 'prepare')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><circle cx="12" cy="13" r="3"/></svg>
                    Take Photo
                  </button>
                  <button style="width:100%; padding:16px; background:#fff; border:1px solid #e5e5e5; border-radius:100px; font-size:15px; font-weight:500; cursor:pointer;" onclick="setScreen('mobile', 'prepare')">Upload Photo</button>
                </div>
              </div>
            </div>

            <!-- PREPARE SCREEN -->
            <div class="screen" id="mobile-prepare">
              <div class="widget-header">
                <button class="btn-icon" onclick="setScreen('mobile', 'entry')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div class="canvas-area">
                <img class="room" src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=800&q=80" alt="Room">
              </div>
              <div class="widget-footer" style="display:flex; flex-direction:column; gap:12px;">
                <p style="text-align:center; color:#737373; font-size:13px; margin:0;">Paint over objects to remove them</p>
                <div class="brush-size-control">
                  <span>Brush Size</span>
                  <input type="range" class="brush-slider" min="10" max="80" value="40">
                </div>
                <div style="display:flex; gap:8px;">
                  <button style="flex:1; padding:14px; background:#fff; border:1px solid #e5e5e5; border-radius:10px; font-weight:500; cursor:pointer;">Undo</button>
                  <button style="flex:1; padding:14px; background:#fff; border:1px solid #e5e5e5; border-radius:10px; font-weight:500; cursor:pointer;">Erase</button>
                  <button class="btn-primary" style="flex:1;" onclick="setScreen('mobile', 'position')">Continue</button>
                </div>
              </div>
            </div>

            <!-- POSITION SCREEN -->
            <div class="screen active" id="mobile-position">
              <div class="widget-header">
                <button class="btn-icon" onclick="setScreen('mobile', 'prepare')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div class="canvas-area">
                <img class="room" src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=800&q=80" alt="Room">
                <div class="product-overlay" id="mobile-product" style="width:120px; left:30px; top:180px;">
                  <img src="https://i.imgur.com/8xqBxKp.png" alt="Product">
                  <!-- Resize handles - visible on touch/hover -->
                  <div class="resize-handle resize-nw"></div>
                  <div class="resize-handle resize-ne"></div>
                  <div class="resize-handle resize-sw"></div>
                  <div class="resize-handle resize-se"></div>
                </div>
                <div class="position-hint">Drag to move • Pinch to resize</div>
              </div>
              <div class="widget-footer">
                <button class="btn-primary" onclick="generateView('mobile')">Generate View</button>
              </div>
            </div>

            <!-- LOADING SCREEN -->
            <div class="screen" id="mobile-loading">
              <div class="widget-header">
                <button class="btn-icon" disabled style="opacity:0.3">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div class="canvas-area">
                <img class="room" src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=800&q=80" alt="Room">
                <div class="loading-overlay show">
                  <div class="spinner"></div>
                  <div class="loading-text">Creating your view...</div>
                </div>
              </div>
              <div class="widget-footer">
                <button class="btn-primary" disabled>Generating...</button>
              </div>
            </div>

            <!-- RESULT SCREEN -->
            <div class="screen" id="mobile-result">
              <div class="widget-header">
                <button class="btn-icon" onclick="setScreen('mobile', 'entry')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div style="flex:1"></div>
                <button class="btn-icon" onclick="closeWidget()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
              </div>
              <div class="result-image-wrap">
                <img src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=800&q=80" alt="Result">
              </div>
              <div class="result-actions">
                <button class="btn-primary" onclick="shareResult()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
                  Share
                </button>
                <div class="result-secondary">
                  <button class="btn-text" onclick="setScreen('mobile', 'entry')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
                    Try Again
                  </button>
                  <button class="btn-text" onclick="showSwiper('mobile')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>
                    Try Another Product
                  </button>
                </div>
              </div>
              <div class="email-section" id="mobile-email-section">
                <div id="mobile-email-form-wrap">
                  <p class="email-label">Save this to your inbox</p>
                  <form class="email-form" onsubmit="submitEmail(event, 'mobile')">
                    <input type="email" placeholder="your@email.com" required>
                    <button type="submit">Send</button>
                  </form>
                </div>
                <div class="email-success" id="mobile-email-success">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  <span>Sent! Check your inbox.</span>
                </div>
              </div>
              
              <!-- Product Swiper - Tinder style -->
              <div class="product-swiper" id="mobile-swiper">
                <button class="swiper-close" onclick="hideSwiper('mobile')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
                
                <div class="swiper-card" id="mobile-card">
                  <img id="mobile-card-img" src="https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=400&q=80" alt="Product">
                  <div class="swiper-card-info">
                    <div class="swiper-card-name" id="mobile-card-name">Velvet Sofa</div>
                    <div class="swiper-card-collection">Living Room Collection</div>
                  </div>
                </div>

                <p class="swiper-hint">Swipe to browse • Tap ✓ to try</p>

                <div class="swiper-actions">
                  <button class="swiper-btn swiper-btn-skip" onclick="swipeCard('mobile', 'left')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                  </button>
                  <button class="swiper-btn swiper-btn-select" onclick="selectSwipeProduct('mobile')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  </button>
                  <button class="swiper-btn swiper-btn-skip" onclick="swipeCard('mobile', 'right')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                  </button>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>

    <!-- DESKTOP -->
    <div class="view-section">
      <h3>Desktop</h3>
      <div class="desktop-frame">
        <div class="desktop-screen">
          <div class="widget" id="desktop-widget">

            <!-- ENTRY SCREEN -->
            <div class="screen" id="desktop-entry">
              <div class="widget-header">
                <button class="btn-icon" onclick="closeWidget()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div style="flex:1; display:flex; flex-direction:column; justify-content:center; align-items:center; padding:48px; text-align:center;">
                <div style="background:#f5f5f5; border-radius:12px; padding:16px 24px; display:flex; gap:16px; align-items:center; margin-bottom:40px;">
                  <img src="https://i.imgur.com/8xqBxKp.png" style="width:64px; height:64px; object-fit:contain; background:#fff; border-radius:8px;">
                  <div style="text-align:left;">
                    <div style="font-weight:600; font-size:16px;">Antique Mirror</div>
                  </div>
                </div>
                <h1 style="font-size:32px; font-weight:600; margin-bottom:12px;">See it in your space</h1>
                <p style="color:#737373; font-size:16px; margin-bottom:40px; max-width:400px;">Upload a photo of your room to see how this piece looks in your home.</p>
                <div style="display:flex; gap:16px;">
                  <button class="btn-primary" style="width:auto; padding:16px 32px;" onclick="setScreen('desktop', 'prepare')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><circle cx="12" cy="13" r="3"/></svg>
                    Upload Photo
                  </button>
                </div>
              </div>
            </div>

            <!-- PREPARE SCREEN -->
            <div class="screen" id="desktop-prepare">
              <div class="widget-header">
                <button class="btn-icon" onclick="setScreen('desktop', 'entry')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div class="canvas-area">
                <img class="room" src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=1200&q=80" alt="Room">
              </div>
              <div class="widget-footer" style="display:flex; align-items:center; gap:16px;">
                <p style="color:#737373; font-size:13px; margin:0;">Paint over objects to remove</p>
                <div class="brush-size-control" style="flex:1; max-width:200px;">
                  <span>Brush Size</span>
                  <input type="range" class="brush-slider" min="10" max="80" value="40">
                </div>
                <button style="padding:12px 24px; background:#fff; border:1px solid #e5e5e5; border-radius:10px; font-weight:500; cursor:pointer;">Undo</button>
                <button style="padding:12px 24px; background:#fff; border:1px solid #e5e5e5; border-radius:10px; font-weight:500; cursor:pointer;">Erase</button>
                <button class="btn-primary" style="width:auto;" onclick="setScreen('desktop', 'position')">Continue</button>
              </div>
            </div>

            <!-- POSITION SCREEN -->
            <div class="screen active" id="desktop-position">
              <div class="widget-header">
                <button class="btn-icon" onclick="setScreen('desktop', 'prepare')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div class="canvas-area">
                <img class="room" src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=1200&q=80" alt="Room">
                <div class="product-overlay" id="desktop-product" style="width:180px; left:100px; top:120px;">
                  <img src="https://i.imgur.com/8xqBxKp.png" alt="Product">
                  <!-- Resize handles -->
                  <div class="resize-handle resize-nw"></div>
                  <div class="resize-handle resize-ne"></div>
                  <div class="resize-handle resize-sw"></div>
                  <div class="resize-handle resize-se"></div>
                </div>
                <div class="position-hint">Drag to move • Drag corners to resize</div>
              </div>
              <div class="widget-footer">
                <button class="btn-primary" onclick="generateView('desktop')">Generate View</button>
              </div>
            </div>

            <!-- LOADING SCREEN -->
            <div class="screen" id="desktop-loading">
              <div class="widget-header">
                <button class="btn-icon" disabled style="opacity:0.3">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div class="header-spacer"></div>
              </div>
              <div class="canvas-area">
                <img class="room" src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=1200&q=80" alt="Room">
                <div class="loading-overlay show">
                  <div class="spinner"></div>
                  <div class="loading-text">Creating your view...</div>
                </div>
              </div>
              <div class="widget-footer">
                <button class="btn-primary" disabled>Generating...</button>
              </div>
            </div>

            <!-- RESULT SCREEN -->
            <div class="screen" id="desktop-result">
              <div class="widget-header">
                <button class="btn-icon" onclick="setScreen('desktop', 'entry')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                </button>
                <div style="flex:1"></div>
                <button class="btn-icon" onclick="closeWidget()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>
              </div>
              <div class="result-image-wrap">
                <img src="https://images.unsplash.com/photo-1616594039964-ae9021a400a0?w=1200&q=80" alt="Result">
              </div>
              <div class="result-actions">
                <button class="btn-primary" onclick="shareResult()">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
                  Share
                </button>
                <div class="result-secondary">
                  <button class="btn-text" onclick="setScreen('desktop', 'entry')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg>
                    Try Again
                  </button>
                  <button class="btn-text" onclick="showSwiper('desktop')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/></svg>
                    Try Another Product
                  </button>
                </div>
              </div>
              <div class="email-section" id="desktop-email-section">
                <p class="email-label">Save this to your inbox</p>
                <div id="desktop-email-form-wrap" style="flex:1; max-width:400px;">
                  <form class="email-form" onsubmit="submitEmail(event, 'desktop')">
                    <input type="email" placeholder="your@email.com" required>
                    <button type="submit">Send</button>
                  </form>
                </div>
                <div class="email-success" id="desktop-email-success">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                  <span>Sent!</span>
                </div>
              </div>
              
              <!-- Product Swiper - Desktop with arrows -->
              <div class="product-swiper" id="desktop-swiper">
                <button class="swiper-close" onclick="hideSwiper('desktop')">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/></svg>
                </button>

                <!-- Desktop nav arrows -->
                <div class="swiper-nav">
                  <button onclick="swipeCard('desktop', 'left')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
                  </button>
                  <button onclick="swipeCard('desktop', 'right')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
                  </button>
                </div>
                
                <div class="swiper-card" id="desktop-card">
                  <img id="desktop-card-img" src="https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=400&q=80" alt="Product">
                  <div class="swiper-card-info">
                    <div class="swiper-card-name" id="desktop-card-name">Velvet Sofa</div>
                    <div class="swiper-card-collection">Living Room Collection</div>
                  </div>
                </div>

                <div class="swiper-actions desktop-actions">
                  <button class="swiper-btn-try" onclick="selectSwipeProduct('desktop')">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24" width="20" height="20"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
                    Try This
                  </button>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script>
    // Screen management
    function setScreen(device, screen) {
      if (device === 'all') {
        setScreen('mobile', screen);
        setScreen('desktop', screen);
        // Update buttons
        document.querySelectorAll('.demo-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        return;
      }

      const screens = ['entry', 'prepare', 'position', 'loading', 'result'];
      screens.forEach(s => {
        const el = document.getElementById(`${device}-${s}`);
        if (el) el.classList.remove('active');
      });
      
      const target = document.getElementById(`${device}-${screen}`);
      if (target) target.classList.add('active');
    }

    // Generate simulation
    function generateView(device) {
      setScreen(device, 'loading');
      setTimeout(() => setScreen(device, 'result'), 2000);
    }

    // Share
    function shareResult() {
      showToast('Image saved to downloads');
    }

    // Email submit
    function submitEmail(e, device) {
      e.preventDefault();
      const input = e.target.querySelector('input');
      const email = input.value;
      
      // Disable form
      const btn = e.target.querySelector('button');
      btn.disabled = true;
      btn.textContent = 'Sending...';

      // Simulate API call
      setTimeout(() => {
        document.getElementById(`${device}-email-form-wrap`).classList.add('hidden');
        document.getElementById(`${device}-email-success`).classList.add('show');
        showToast('Email captured: ' + email);
      }, 800);
    }

    // Toast
    function showToast(msg) {
      const toast = document.getElementById('toast');
      toast.textContent = msg;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2500);
    }

    // Close widget (demo)
    function closeWidget() {
      showToast('Widget closed');
    }

    // Product swiper - Tinder style
    const products = [
      { name: 'Velvet Sofa', img: 'https://images.unsplash.com/photo-1555041469-a586c61ea9bc?w=400&q=80' },
      { name: 'Floor Lamp', img: 'https://images.unsplash.com/photo-1507473885765-e6ed057f782c?w=400&q=80' },
      { name: 'Accent Chair', img: 'https://images.unsplash.com/photo-1493663284031-b7e3aefcae8e?w=400&q=80' },
      { name: 'Console Table', img: 'https://images.unsplash.com/photo-1532372320572-cda25653a26d?w=400&q=80' },
      { name: 'Wall Art', img: 'https://images.unsplash.com/photo-1513519245088-0e12902e35ca?w=400&q=80' },
    ];

    const swiperState = {
      mobile: 0,
      desktop: 0
    };

    function showSwiper(device) {
      swiperState[device] = 0;
      updateSwiperCard(device);
      document.getElementById(`${device}-swiper`).classList.add('show');
    }

    function hideSwiper(device) {
      document.getElementById(`${device}-swiper`).classList.remove('show');
    }

    function updateSwiperCard(device) {
      const idx = swiperState[device];
      const product = products[idx];
      document.getElementById(`${device}-card-img`).src = product.img;
      document.getElementById(`${device}-card-name`).textContent = product.name;
    }

    function swipeCard(device, direction) {
      const card = document.getElementById(`${device}-card`);
      card.classList.add(direction === 'left' ? 'swiping-left' : 'swiping-right');
      
      setTimeout(() => {
        card.classList.remove('swiping-left', 'swiping-right');
        
        if (direction === 'right') {
          swiperState[device] = (swiperState[device] + 1) % products.length;
        } else {
          swiperState[device] = (swiperState[device] - 1 + products.length) % products.length;
        }
        updateSwiperCard(device);
      }, 150);
    }

    function selectSwipeProduct(device) {
      const product = products[swiperState[device]];
      hideSwiper(device);
      showToast('Loading ' + product.name + '...');
      setTimeout(() => {
        setScreen(device, 'position');
        showToast('Position ' + product.name + ' and generate');
      }, 500);
    }

    // Touch swipe for mobile
    ['mobile-card', 'desktop-card'].forEach(id => {
      const card = document.getElementById(id);
      if (!card) return;
      
      const device = id.split('-')[0];
      let startX = 0;
      let currentX = 0;

      card.addEventListener('touchstart', (e) => {
        startX = e.touches[0].clientX;
      });

      card.addEventListener('touchmove', (e) => {
        currentX = e.touches[0].clientX;
        const diff = currentX - startX;
        card.style.transform = `translateX(${diff}px) rotate(${diff * 0.05}deg)`;
      });

      card.addEventListener('touchend', () => {
        const diff = currentX - startX;
        card.style.transform = '';
        
        if (Math.abs(diff) > 80) {
          swipeCard(device, diff > 0 ? 'right' : 'left');
        }
        startX = 0;
        currentX = 0;
      });
    });

    // Simple drag for product overlay
    ['mobile-product', 'desktop-product'].forEach(id => {
      const el = document.getElementById(id);
      if (!el) return;
      
      const device = id.split('-')[0];
      const hint = el.parentElement?.querySelector('.position-hint');
      
      let isDragging = false;
      let isResizing = false;
      let startX, startY, startLeft, startTop, startWidth;

      const hideHint = () => {
        if (hint) hint.classList.add('hidden');
      };

      // Drag
      el.addEventListener('pointerdown', (e) => {
        if (e.target.classList.contains('resize-handle')) return;
        isDragging = true;
        el.classList.add('dragging');
        startX = e.clientX;
        startY = e.clientY;
        startLeft = el.offsetLeft;
        startTop = el.offsetTop;
        hideHint();
        e.preventDefault();
      });

      // Resize handles
      el.querySelectorAll('.resize-handle').forEach(handle => {
        handle.addEventListener('pointerdown', (e) => {
          isResizing = true;
          el.classList.add('resizing');
          startX = e.clientX;
          startWidth = el.offsetWidth;
          hideHint();
          e.preventDefault();
          e.stopPropagation();
        });
      });

      document.addEventListener('pointermove', (e) => {
        if (isDragging) {
          el.style.left = (startLeft + e.clientX - startX) + 'px';
          el.style.top = (startTop + e.clientY - startY) + 'px';
        }
        if (isResizing) {
          const newWidth = Math.max(60, startWidth + (e.clientX - startX));
          el.style.width = newWidth + 'px';
        }
      });

      document.addEventListener('pointerup', () => {
        isDragging = false;
        isResizing = false;
        el.classList.remove('dragging', 'resizing');
      });

      // Pinch to zoom for mobile
      let initialDistance = 0;
      let initialWidth = 0;

      el.addEventListener('touchstart', (e) => {
        if (e.touches.length === 2) {
          initialDistance = Math.hypot(
            e.touches[0].clientX - e.touches[1].clientX,
            e.touches[0].clientY - e.touches[1].clientY
          );
          initialWidth = el.offsetWidth;
          hideHint();
          e.preventDefault();
        }
      }, { passive: false });

      el.addEventListener('touchmove', (e) => {
        if (e.touches.length === 2 && initialDistance > 0) {
          const currentDistance = Math.hypot(
            e.touches[0].clientX - e.touches[1].clientX,
            e.touches[0].clientY - e.touches[1].clientY
          );
          const scale = currentDistance / initialDistance;
          const newWidth = Math.max(60, Math.min(400, initialWidth * scale));
          el.style.width = newWidth + 'px';
          e.preventDefault();
        }
      }, { passive: false });

      el.addEventListener('touchend', () => {
        initialDistance = 0;
      });
    });
  </script>
</body>
</html>
